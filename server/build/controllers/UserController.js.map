{"version":3,"sources":["../../src/controllers/UserController.js"],"names":["mongoose","require","passport","User","model","user","userLogin","req","res","next","authenticate","err","info","sendStatus","logIn","send","userLogout","logout","userRegister","register","username","body","email","password","console","log","module","exports"],"mappings":";;AAAA,IAAMA,WAAWC,QAAQ,UAAR,CAAjB;AACA,IAAMC,WAAWD,QAAQ,UAAR,CAAjB;AACAA,QAAQ,gBAAR;;AAEA,IAAME,OAAOH,SAASI,KAAT,CAAe,OAAf,CAAb;;AAEA,IAAMC,OAAO;AACXC,aAAW,mBAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC7BP,aAASQ,YAAT,CAAsB,OAAtB,EAA+B,UAASC,GAAT,EAAcN,IAAd,EAAoBO,IAApB,EAA0B;AACvD,UAAID,GAAJ,EAAS;AACP,eAAOF,KAAKE,GAAL,CAAP;AACD;AACD,UAAI,CAACN,IAAL,EAAW;AACT,eAAOG,IAAIK,UAAJ,CAAe,GAAf,CAAP;AACD;;AAEDN,UAAIO,KAAJ,CAAUT,IAAV,EAAgB,UAASM,GAAT,EAAc;AAC5B,YAAIA,GAAJ,EAAS;AACP,iBAAOF,KAAKE,GAAL,CAAP;AACD;AACD,eAAOH,IAAIO,IAAJ,CAASV,IAAT,CAAP;AACD,OALD;AAMD,KAdD,EAcGE,GAdH,EAcQC,GAdR,EAcaC,IAdb;AAeD,GAjBU;AAkBXO,cAAY,oBAACT,GAAD,EAAMC,GAAN,EAAc;AACxBD,QAAIU,MAAJ;AACAT,QAAIK,UAAJ,CAAe,GAAf;AACD,GArBU;AAsBXK,gBAAc,sBAACX,GAAD,EAAMC,GAAN,EAAc;AAC1BL,SAAKgB,QAAL,CACE,IAAIhB,IAAJ,CAAS;AACPiB,gBAAUb,IAAIc,IAAJ,CAASD,QADZ;AAEPE,aAAOf,IAAIc,IAAJ,CAASC;AAFT,KAAT,CADF,EAKEf,IAAIc,IAAJ,CAASE,QALX,EAME,UAASZ,GAAT,EAAcN,IAAd,EAAoB;AAClB,UAAIM,GAAJ,EAAS;AACPa,gBAAQC,GAAR,CAAYd,GAAZ;AACA,eAAOH,IAAIK,UAAJ,CAAe,GAAf,CAAP;AACD,OAHD,MAGO;AACLX,iBAASQ,YAAT,CAAsB,OAAtB,EAA+BH,GAA/B,EAAoCC,GAApC,EAAyC,YAAW;AAClDA,cAAIK,UAAJ,CAAe,GAAf;AACD,SAFD;AAGD;AACF,KAfH;AAiBD;AAxCU,CAAb;;AA2CAa,OAAOC,OAAP,GAAiBtB,IAAjB","file":"UserController.js","sourcesContent":["const mongoose = require(\"mongoose\");\r\nconst passport = require(\"passport\");\r\nrequire(\"../models/User\");\r\n\r\nconst User = mongoose.model(\"Users\");\r\n\r\nconst user = {\r\n  userLogin: (req, res, next) => {\r\n    passport.authenticate(\"local\", function(err, user, info) {\r\n      if (err) {\r\n        return next(err);\r\n      }\r\n      if (!user) {\r\n        return res.sendStatus(403);\r\n      }\r\n\r\n      req.logIn(user, function(err) {\r\n        if (err) {\r\n          return next(err);\r\n        }\r\n        return res.send(user);\r\n      });\r\n    })(req, res, next);\r\n  },\r\n  userLogout: (req, res) => {\r\n    req.logout();\r\n    res.sendStatus(200);\r\n  },\r\n  userRegister: (req, res) => {\r\n    User.register(\r\n      new User({\r\n        username: req.body.username,\r\n        email: req.body.email\r\n      }),\r\n      req.body.password,\r\n      function(err, user) {\r\n        if (err) {\r\n          console.log(err);\r\n          return res.sendStatus(500);\r\n        } else {\r\n          passport.authenticate(\"local\")(req, res, function() {\r\n            res.sendStatus(201);\r\n          });\r\n        }\r\n      }\r\n    );\r\n  }\r\n};\r\n\r\nmodule.exports = user;\r\n"]}